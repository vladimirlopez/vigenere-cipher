(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(e){if(e.ep)return;e.ep=!0;const n=o(e);fetch(e.href,n)}})();const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ";let l=0,L=null,u=!0;const v=document.getElementById("keyword-input"),h=document.getElementById("message-input"),O=document.getElementById("btn-prev"),R=document.getElementById("btn-next"),x=document.getElementById("btn-auto"),U=document.getElementById("btn-reset"),C=document.getElementById("mode-encode"),I=document.getElementById("mode-decode"),b=document.getElementById("result-display"),g=document.getElementById("tutorial-status"),A=document.getElementById("key-expansion"),E=document.getElementById("tabula-recta");function H(){Z(),y(),N()}function Z(){const t=document.createElement("div");t.classList.add("grid-cell","grid-corner"),t.textContent="+",E.appendChild(t);for(let c=0;c<26;c++){const o=document.createElement("div");o.classList.add("grid-cell","grid-header-row"),o.textContent=i[c],o.id=`header-col-${c}`,E.appendChild(o)}for(let c=0;c<26;c++){const o=document.createElement("div");o.classList.add("grid-cell","grid-header-col"),o.textContent=i[c],o.id=`header-row-${c}`,E.appendChild(o);for(let s=0;s<26;s++){const e=document.createElement("div");e.classList.add("grid-cell");const n=(c+s)%26;e.textContent=i[n],e.id=`cell-${c}-${s}`,E.appendChild(e)}}}function y(){l=-1,p(),b.textContent="",B(),M(),k();const t=u?"encrypt":"decrypt";g.textContent=`Ready. Click 'Next Letter' to ${t} the first character.`}function B(){document.querySelectorAll(".highlight-row").forEach(t=>t.classList.remove("highlight-row")),document.querySelectorAll(".highlight-col").forEach(t=>t.classList.remove("highlight-col")),document.querySelectorAll(".highlight-intersect").forEach(t=>t.classList.remove("highlight-intersect")),document.querySelectorAll(".active-stack").forEach(t=>t.classList.remove("active-stack"))}function M(){const t=h.value.toUpperCase().replace(/[^A-Z]/g,""),c=v.value.toUpperCase().replace(/[^A-Z]/g,"");if(A.innerHTML="",c.length!==0)for(let o=0;o<t.length;o++){const s=c[o%c.length],e=t[o],n=document.createElement("div");n.classList.add("char-stack"),n.id=`stack-${o}`,u?n.innerHTML=`
                <span class="char-key">${s}</span>
                <span class="char-plain">${e}</span>
                <span class="char-cipher" id="output-char-${o}">-</span>
            `:n.innerHTML=`
                <span class="char-key">${s}</span>
                <span class="char-cipher">${e}</span>
                <span class="char-plain" id="output-char-${o}">-</span>
            `,A.appendChild(n)}}function $(){const t=h.value.toUpperCase().replace(/[^A-Z]/g,""),c=v.value.toUpperCase().replace(/[^A-Z]/g,"");if(t.length===0||c.length===0){g.textContent="Please enter both a keyword and a message.";return}l<t.length-1?(l++,S(t,c)):(p(),g.textContent=u?"Encryption complete!":"Decryption complete!"),k()}function T(){if(l>=0){l--;const t=h.value.toUpperCase().replace(/[^A-Z]/g,""),c=v.value.toUpperCase().replace(/[^A-Z]/g,""),o=document.getElementById(`output-char-${l+1}`);o&&(o.textContent="-");let s="";for(let e=0;e<=l;e++){const n=t[e],a=c[e%c.length],d=i.indexOf(n),m=i.indexOf(a);u?s+=i[(d+m)%26]:s+=i[(d-m+26)%26]}if(b.textContent=s,l===-1){B();const e=u?"encrypt":"decrypt";g.textContent=`Ready. Click 'Next Letter' to ${e} the first character.`}else S(t,c)}k()}function S(t,c){B();const o=t[l],s=c[l%c.length],e=i.indexOf(o),n=i.indexOf(s);let a,d;if(u){d=(e+n)%26,a=i[d],document.getElementById(`header-row-${n}`).classList.add("highlight-row");for(let r=0;r<26;r++)document.getElementById(`cell-${n}-${r}`).classList.add("highlight-row");document.getElementById(`header-col-${e}`).classList.add("highlight-col");for(let r=0;r<26;r++)document.getElementById(`cell-${r}-${e}`).classList.add("highlight-col");const f=document.getElementById(`cell-${n}-${e}`);f.classList.add("highlight-intersect"),f.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),g.innerHTML=`Encrypting '<b>${o}</b>' with Key '<b>${s}</b>'.<br>Intersection of Key-Row <b>${s}</b> and Plain-Col <b>${o}</b> is <b>${a}</b>.`}else{d=(e-n+26)%26,a=i[d],document.getElementById(`header-row-${n}`).classList.add("highlight-row");for(let r=0;r<26;r++)document.getElementById(`cell-${n}-${r}`).classList.add("highlight-row");const f=document.getElementById(`cell-${n}-${d}`);f.classList.add("highlight-intersect"),f.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),document.getElementById(`header-col-${d}`).classList.add("highlight-col");for(let r=0;r<26;r++)document.getElementById(`cell-${r}-${d}`).classList.add("highlight-col");g.innerHTML=`Decrypting '<b>${o}</b>' with Key '<b>${s}</b>'.<br>Find <b>${o}</b> in Key-Row <b>${s}</b>. <br>Look UP to the header to find Plaintext <b>${a}</b>.`}const m=document.getElementById(`stack-${l}`);m&&m.classList.add("active-stack");const w=document.getElementById(`output-char-${l}`);w&&(w.textContent=a),b.textContent.length<=l&&(b.textContent+=a)}function k(){const t=h.value.toUpperCase().replace(/[^A-Z]/g,"");O.disabled=l<0,R.disabled=l>=t.length-1}function K(){L?p():(x.textContent="Pause",$(),L=setInterval(()=>{const t=h.value.toUpperCase().replace(/[^A-Z]/g,"");l>=t.length-1?p():$()},1200))}function p(){clearInterval(L),L=null,x.textContent="Auto Play"}function P(t){u!==t&&(u=t,u?(C.classList.add("active"),I.classList.remove("active"),h.placeholder="message to encrypt..."):(I.classList.add("active"),C.classList.remove("active"),h.placeholder="ciphertext to decrypt..."),y())}function N(){R.addEventListener("click",()=>{p(),$()}),O.addEventListener("click",()=>{p(),T()}),x.addEventListener("click",K),U.addEventListener("click",y),C.addEventListener("click",()=>P(!0)),I.addEventListener("click",()=>P(!1)),v.addEventListener("input",()=>{y()}),h.addEventListener("input",()=>{y()})}H();
